<!DOCTYPE html><html><head><title>Two-Factor Authentication with Authy</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Two-Factor Authentication with Authy"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Two-Factor Authentication with Authy</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement two-factor authentication (2FA) in your web app with Twilio-powered Authy. 2FA helps further secure your users' data by validating more than just a password. This tutorial will show you the code to make it happen.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Application Setup" class="chapter"><div data-title="How it Works" data-file="app/models/user.rb" data-highlight="" class="step"><h2 id="how-it-works">How It Works</h2>
<p>Adding two-factor authentication (2FA) to your web application can help increase the security of your user&#39;s data. <a href="http://en.wikipedia.org/wiki/Multi-factor_authentication">Multi-factor authentication</a> determines the identity of a user by validating one or more of the following &quot;factors&quot;:</p>
<ul>
<li><em>Knowledge Factors</em> (Something a user knows, like a password)</li>
<li><em>Posession Factors</em> (Something a user has, like a mobile phone)</li>
<li><em>Inheritance Factors</em> (Something a user is, like a person with a unique finger print)</li>
</ul>
<p>We&#39;re about to walk you through a sample application that implements a simple login system with a <em>knowledge factor</em> and a <em>posession factor</em>. For the knowledge factor, we will use a standard username/password system. For the possession factor, we will validate that the user has their mobile phone by sending them a one-time passcode in a text message <a href="http://www.authy.com/">sent with Authy via Twilio</a>. Here&#39;s how this works at a high level:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-high-level.png" alt="2FA High Level"></p>
<p>Now it&#39;s time to look at some code! We&#39;ll begin by understanding the moving parts of this example <a href="http://rubyonrails.org/">Ruby on Rails</a> application before diving into the actual implementation of the login flow.</p>
</div><div data-title="Our App's Dependencies" data-file="Gemfile" data-language="ruby" class="step"><h2 id="our-app-s-dependencies">Our App&#39;s Dependencies</h2>
<p>Our application&#39;s <code>Gemfile</code> contains a standard array of Ruby gems to support our Rails application. One addition we&#39;ve made is the <a href="https://github.com/authy/authy-ruby">Authy Ruby gem</a> to make integration with Authy&#39;s 2FA API a bit simpler.</p>
<p>In addition to the Authy gem, we need to configure our Authy API key. Let&#39;s look at how we do that.</p>
</div><div data-title="Configuring Authy" data-file="config/initializers/authy.rb" data-highlight="" class="step"><h2 id="configuring-authy">Configuring Authy</h2>
<p>If you haven&#39;t already, now is the time to <a href="https://dashboard.authy.com/signup">sign up for Authy</a>. Create your first application, naming it whatever you wish. After you create your application, your &quot;production&quot; API key will be visible on your <a href="https://dashboard.authy.com">dashboard</a>:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-authy-dashboard.png" alt="Authy Dashboard"></p>
<p>Once we have an Authy API key, we store it in this <a href="http://guides.rubyonrails.org/configuring.html">initializer file</a>. Rather than storing it as a string, we pull it in from a system environment variable in the <code>ENV</code> hash. This prevents us from accidentally checking this sensitive value into source control.</p>
<p>Now that we&#39;ve configured our Rails app, let&#39;s take a look at the domain model we&#39;ll need to create our user login system.</p>
</div><div data-title="The Login System" data-file="db/schema.rb" data-highlight="" class="step"><h2 id="what-goes-into-a-login-system-">What Goes Into a Login System?</h2>
<p>Authentication and authorization are some of the trickiest concepts to get right in a web application, and implementations vary quite a bit from application to application. But generally speaking, every login system has two concepts to implement:</p>
<ul>
<li><code>User</code> : An individual person using the system</li>
<li><code>Session</code> : A series of authenticated interations a user has with the system</li>
</ul>
<p>Our application implements an ActiveRecord model object for the user, and will use an HTTP session to track login status.</p>
<p>Our <code>User</code> model has a name, e-mail address, phone number, and a hashed password to compare against user-entered passwords during the login step. It also has an &quot;Authy ID&quot; which will associate our ActiveRecord user model with an Authy API user. Creating this association lets us use Authy to send our user 2FA verification codes, and verify user-entered one-time passwords.</p>
<p>Next, let&#39;s take a look at how to actually implement 2FA in our application, starting with the creation of user accounts.</p>
</div></div><div data-title="Creating a User" class="chapter"><div data-title="Creating a User" data-file="app/controllers/users_controller.rb" data-highlight="" class="step"><h2 id="creating-a-user">Creating a User</h2>
<p>To create a user, we will need a Rails controller that handles two routes - one to display the new <code>User</code> form, and another to actually create the <code>User</code> model.  We&#39;ll come back to the controller in a second, but let&#39;s first take a look at the form our user will fill out to create a new User account.</p>
</div><div data-title="New User Form" data-file="app/views/users/new.html.erb" data-language="htmlembedded" class="step"><h2 id="new-user-form">New User Form</h2>
<p>When we create a new user, we ask for a name, e-mail address, and a password to power the knowledge factor of our authentication scheme. To enable 2FA, we also ask them for a mobile number with a country code, which we can use with Authy to send them one-time passwords via SMS.</p>
<p>Let&#39;s jump back over to the controller to see what happens when we create a user.</p>
</div><div data-title="Handling the Form POST" data-file="app/controllers/users_controller.rb" data-highlight="6-20" class="step"><h2 id="handling-the-form-post">Handling the Form POST</h2>
<p>In our controller we take the input from our form and create a new <code>User</code> model. If the user is saved to the database successfully, we use the Authy gem to create a corresponding Authy User and save the ID for that user in our database.</p>
<p>Now we have a user that can log in to our system. Let&#39;s check out the actual login flow next.</p>
</div></div><div data-title="Logging In" class="chapter"><div data-title="Logging In with 2FA" data-file="app/controllers/sessions_controller.rb" data-highlight="" class="step"><h2 id="logging-in-with-2fa">Logging In with 2FA</h2>
<p>Our sessions controller handles all the steps involved in logging our user into the application. There&#39;s a number of steps involved in this process, but our first order of business is to validate the user&#39;s e-mail address and password. Let&#39;s check out how we do that first.</p>
</div><div data-title="Checking the Password" data-file="app/controllers/sessions_controller.rb" data-highlight="2-16" class="step"><h2 id="checking-the-password">Checking the Password</h2>
<p>These two route handlers are responsible for displaying our login form and handling a login form submission. We won&#39;t look at the HTML for the login form, as it&#39;s pretty basic - just two text fields for an e-mail and password.  The <code>new</code> method handles rendering that view for the <code>/sessions/new</code> route. With a little CSS assist from <a href="http://getbootstrap.com/">Twitter Bootstrap</a> and <a href="http://fortawesome.github.io/Font-Awesome/">Font Awesome</a>, the login form will look something like this:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-login.png" alt="The Login Form"></p>
<p>The <code>create</code> route verifies the e-mail and password that are submitted by the user. If the password matches, the user&#39;s database ID is stored in the session object as <code>pre_2fa_auth_user_id</code> so we can refer to it later. </p>
<p>Next, we use the Authy API to send a one-time password to the user&#39;s phone. The user will need to successfully enter the code Authy sends them on our web form to complete their login to our system. Let&#39;s check out how we do that next.</p>
</div><div data-title="The 2FA Step" data-file="app/controllers/sessions_controller.rb" data-highlight="18-33" class="step"><h2 id="the-2fa-step">The 2FA Step</h2>
<p>These two route handlers are responsible for displaying a form to enter the Authy verification code, and then validate the code that they entered.</p>
<p>The <code>two_factor</code> method displays a view with a single text field to enter the 2FA token sent previously via the Authy API. The verification form will look something like this to the end user:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-verify.png" alt="The Verification Form"></p>
<p>The <code>verify</code> method is responsible for validating the token sent to our user via SMS.  First, we grab the <code>User</code> model by the ID we stored in the session during the previous step in <code>pre_2fa_auth_user_id</code>.  Next, we use the Authy API to validate the token our user entered against the one Authy sent them.  If the two match, our login process is complete!  We store the user&#39;s database ID in the session object as <code>user_id</code>, which we use to indicate that the user has sucessfully logged in to our application.</p>
<p>To wrap things up, let&#39;s see how we protect routes in our application based on the information we&#39;ve stored in the session.</p>
</div></div><div data-title="Accessing Protected Resources" class="chapter"><div data-title="Protecting Sensitive Data" data-file="app/controllers/application_controller.rb" data-highlight="" class="step"><h2 id="protecting-sensitive-data">Protecting Sensitive Data</h2>
<p>In our application controller, which all our other controllers extend, we put helpers in place to use information in the session object to get information about the currently logged in user (if one exists).</p>
<p>Notably, we provide a protected <code>authenticate!</code> method which will redirect to our login page if there&#39;s no user associated with the current HTTP session.  Any controller in our application can use this method to protect sensitive routes - let&#39;s check out a quick example of this in action.</p>
</div><div data-title="Protecting Routes" data-file="app/controllers/accounts_controller.rb" class="step"><h2 id="protecting-routes">Protecting Routes</h2>
<p>Our accounts controller only has a single route, but it applies <code>authenticate!</code> as a <code>before_filter</code> on all its routes. This protects the <code>show</code> route and any others we might add to this controller from being accessed by anyone who is not logged in to our application.</p>
<h2 id="all-done-">All Done!</h2>
<p>And that&#39;s it! We&#39;ve just implemented two-factor authentication in our Ruby on Rails application. Of course, there&#39;s much more we could do - requiring 2FA on every login attempt might be excessive for our users, so we might only require it for particularly sensitive requests and routes.</p>
<p>Authy also provides <a href="https://www.authy.com/users">a mobile app</a> to generate tokens, so users with a smartphone might be able to take advantage of this option also. We might provide some guidance to this resource for users that want to take advantage of it.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share with us, we&#39;d love to hear it. Tweet <a href="http://twitter.com/twilio">@twilio</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="app/models/user.rb" data-mode="ruby">Y2xhc3MgVXNlciA8IEFjdGl2ZVJlY29yZDo6QmFzZQogIGhhc19zZWN1cmVfcGFzc3dvcmQKCiAgdmFsaWRhdGVzIDplbWFpbCwgIHByZXNlbmNlOiB0cnVlLCBmb3JtYXQ6IHsgd2l0aDogL1xBLitALiskXFovIH0sIHVuaXF1ZW5lc3M6IHRydWUKICB2YWxpZGF0ZXMgOm5hbWUsIHByZXNlbmNlOiB0cnVlCiAgdmFsaWRhdGVzIDpjb3VudHJ5X2NvZGUsIHByZXNlbmNlOiB0cnVlCiAgdmFsaWRhdGVzIDpwaG9uZV9udW1iZXIsIHByZXNlbmNlOiB0cnVlCmVuZAo=</textarea>
<textarea class="saurus-file" data-file="Gemfile" data-mode="ruby">c291cmNlICdodHRwczovL3J1YnlnZW1zLm9yZycKCgojIEJ1bmRsZSBlZGdlIFJhaWxzIGluc3RlYWQ6IGdlbSAncmFpbHMnLCBnaXRodWI6ICdyYWlscy9yYWlscycKZ2VtICdyYWlscycsICc0LjIuMCcKIyBVc2UgcG9zdGdyZXNxbCBhcyB0aGUgZGF0YWJhc2UgZm9yIEFjdGl2ZSBSZWNvcmQKZ2VtICdwZycKIyBVc2UgU0NTUyBmb3Igc3R5bGVzaGVldHMKZ2VtICdzYXNzLXJhaWxzJywgJ34+IDUuMCcKIyBVc2UgVWdsaWZpZXIgYXMgY29tcHJlc3NvciBmb3IgSmF2YVNjcmlwdCBhc3NldHMKZ2VtICd1Z2xpZmllcicsICc+PSAxLjMuMCcKIyBVc2UgQ29mZmVlU2NyaXB0IGZvciAuY29mZmVlIGFzc2V0cyBhbmQgdmlld3MKZ2VtICdjb2ZmZWUtcmFpbHMnLCAnfj4gNC4xLjAnCiMgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zc3RlcGhlbnNvbi9leGVjanMjcmVhZG1lIGZvciBtb3JlIHN1cHBvcnRlZCBydW50aW1lcwojIGdlbSAndGhlcnVieXJhY2VyJywgcGxhdGZvcm1zOiA6cnVieQoKIyBVc2UganF1ZXJ5IGFzIHRoZSBKYXZhU2NyaXB0IGxpYnJhcnkKZ2VtICdqcXVlcnktcmFpbHMnCiMgVHVyYm9saW5rcyBtYWtlcyBmb2xsb3dpbmcgbGlua3MgaW4geW91ciB3ZWIgYXBwbGljYXRpb24gZmFzdGVyLiBSZWFkIG1vcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYWlscy90dXJib2xpbmtzCmdlbSAndHVyYm9saW5rcycKIyBCdWlsZCBKU09OIEFQSXMgd2l0aCBlYXNlLiBSZWFkIG1vcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yYWlscy9qYnVpbGRlcgpnZW0gJ2pidWlsZGVyJywgJ34+IDIuMCcKIyBidW5kbGUgZXhlYyByYWtlIGRvYzpyYWlscyBnZW5lcmF0ZXMgdGhlIEFQSSB1bmRlciBkb2MvYXBpLgpnZW0gJ3Nkb2MnLCAnfj4gMC40LjAnLCBncm91cDogOmRvYwoKIyBVc2UgQWN0aXZlTW9kZWwgaGFzX3NlY3VyZV9wYXNzd29yZApnZW0gJ2JjcnlwdCcsICd+PiAzLjEuNycKCiMgVXNlIEF1dGh5IGZvciAyRkEKZ2VtICdhdXRoeScKCiMgVXNlIFVuaWNvcm4gYXMgdGhlIGFwcCBzZXJ2ZXIKZ2VtICd1bmljb3JuJwoKZ3JvdXAgOnByb2R1Y3Rpb24gZG8KICBnZW0gJ3JhaWxzXzEyZmFjdG9yJwplbmQKCmdyb3VwIDpkZXZlbG9wbWVudCwgOnRlc3QgZG8KICAjIENhbGwgJ2J5ZWJ1ZycgYW55d2hlcmUgaW4gdGhlIGNvZGUgdG8gc3RvcCBleGVjdXRpb24gYW5kIGdldCBhIGRlYnVnZ2VyIGNvbnNvbGUKICBnZW0gJ2J5ZWJ1ZycKCiAgIyBBY2Nlc3MgYW4gSVJCIGNvbnNvbGUgb24gZXhjZXB0aW9uIHBhZ2VzIG9yIGJ5IHVzaW5nIDwlPSBjb25zb2xlICU+IGluIHZpZXdzCiAgZ2VtICd3ZWItY29uc29sZScsICd+PiAyLjAnCgogICMgU3ByaW5nIHNwZWVkcyB1cCBkZXZlbG9wbWVudCBieSBrZWVwaW5nIHlvdXIgYXBwbGljYXRpb24gcnVubmluZyBpbiB0aGUgYmFja2dyb3VuZC4gUmVhZCBtb3JlOiBodHRwczovL2dpdGh1Yi5jb20vcmFpbHMvc3ByaW5nCiAgZ2VtICdzcHJpbmcnCgogICMgTW9jaGEgZm9yIG1vY2tpbmcKICBnZW0gJ21vY2hhJwplbmQKCg==</textarea>
<textarea class="saurus-file" data-file="config/initializers/authy.rb" data-mode="ruby">QXV0aHkuYXBpX2tleSA9IFJhaWxzLmFwcGxpY2F0aW9uLnNlY3JldHMuYXV0aHlfa2V5CkF1dGh5LmFwaV91cmkgPSAnaHR0cHM6Ly9hcGkuYXV0aHkuY29tLycK</textarea>
<textarea class="saurus-file" data-file="db/schema.rb" data-mode="ruby">IyBlbmNvZGluZzogVVRGLTgKIyBUaGlzIGZpbGUgaXMgYXV0by1nZW5lcmF0ZWQgZnJvbSB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZGF0YWJhc2UuIEluc3RlYWQKIyBvZiBlZGl0aW5nIHRoaXMgZmlsZSwgcGxlYXNlIHVzZSB0aGUgbWlncmF0aW9ucyBmZWF0dXJlIG9mIEFjdGl2ZSBSZWNvcmQgdG8KIyBpbmNyZW1lbnRhbGx5IG1vZGlmeSB5b3VyIGRhdGFiYXNlLCBhbmQgdGhlbiByZWdlbmVyYXRlIHRoaXMgc2NoZW1hIGRlZmluaXRpb24uCiMKIyBOb3RlIHRoYXQgdGhpcyBzY2hlbWEucmIgZGVmaW5pdGlvbiBpcyB0aGUgYXV0aG9yaXRhdGl2ZSBzb3VyY2UgZm9yIHlvdXIKIyBkYXRhYmFzZSBzY2hlbWEuIElmIHlvdSBuZWVkIHRvIGNyZWF0ZSB0aGUgYXBwbGljYXRpb24gZGF0YWJhc2Ugb24gYW5vdGhlcgojIHN5c3RlbSwgeW91IHNob3VsZCBiZSB1c2luZyBkYjpzY2hlbWE6bG9hZCwgbm90IHJ1bm5pbmcgYWxsIHRoZSBtaWdyYXRpb25zCiMgZnJvbSBzY3JhdGNoLiBUaGUgbGF0dGVyIGlzIGEgZmxhd2VkIGFuZCB1bnN1c3RhaW5hYmxlIGFwcHJvYWNoICh0aGUgbW9yZSBtaWdyYXRpb25zCiMgeW91J2xsIGFtYXNzLCB0aGUgc2xvd2VyIGl0J2xsIHJ1biBhbmQgdGhlIGdyZWF0ZXIgbGlrZWxpaG9vZCBmb3IgaXNzdWVzKS4KIwojIEl0J3Mgc3Ryb25nbHkgcmVjb21tZW5kZWQgdGhhdCB5b3UgY2hlY2sgdGhpcyBmaWxlIGludG8geW91ciB2ZXJzaW9uIGNvbnRyb2wgc3lzdGVtLgoKQWN0aXZlUmVjb3JkOjpTY2hlbWEuZGVmaW5lKHZlcnNpb246IDIwMTUwMjIwMTcxMDQ5KSBkbwoKICAjIFRoZXNlIGFyZSBleHRlbnNpb25zIHRoYXQgbXVzdCBiZSBlbmFibGVkIGluIG9yZGVyIHRvIHN1cHBvcnQgdGhpcyBkYXRhYmFzZQogIGVuYWJsZV9leHRlbnNpb24gInBscGdzcWwiCgogIGNyZWF0ZV90YWJsZSAidXNlcnMiLCBmb3JjZTogOmNhc2NhZGUgZG8gfHR8CiAgICB0LnN0cmluZyAgICJlbWFpbCIsICAgICAgICAgICBudWxsOiBmYWxzZQogICAgdC5zdHJpbmcgICAicGFzc3dvcmRfZGlnZXN0IiwgbnVsbDogZmFsc2UKICAgIHQuZGF0ZXRpbWUgImNyZWF0ZWRfYXQiLCAgICAgIG51bGw6IGZhbHNlCiAgICB0LmRhdGV0aW1lICJ1cGRhdGVkX2F0IiwgICAgICBudWxsOiBmYWxzZQogICAgdC5zdHJpbmcgICAibmFtZSIKICAgIHQuc3RyaW5nICAgInBob25lX251bWJlciIKICAgIHQuc3RyaW5nICAgImNvdW50cnlfY29kZSIKICAgIHQuc3RyaW5nICAgImF1dGh5X2lkIgogIGVuZAoKZW5kCg==</textarea>
<textarea class="saurus-file" data-file="app/controllers/users_controller.rb" data-mode="ruby">Y2xhc3MgVXNlcnNDb250cm9sbGVyIDwgQXBwbGljYXRpb25Db250cm9sbGVyCiAgZGVmIG5ldwogICAgQHVzZXIgPSBVc2VyLm5ldwogIGVuZAoKICBkZWYgY3JlYXRlCiAgICBAdXNlciA9IFVzZXIubmV3KHVzZXJfcGFyYW1zKQogICAgaWYgQHVzZXIuc2F2ZQogICAgICBzZXNzaW9uWzp1c2VyX2lkXSA9IEB1c2VyLmlkCiAgICAgIGF1dGh5ID0gQXV0aHk6OkFQSS5yZWdpc3Rlcl91c2VyKAogICAgICAgIGVtYWlsOiBAdXNlci5lbWFpbCwKICAgICAgICBjZWxscGhvbmU6IEB1c2VyLnBob25lX251bWJlciwKICAgICAgICBjb3VudHJ5X2NvZGU6IEB1c2VyLmNvdW50cnlfY29kZQogICAgICApCiAgICAgIEB1c2VyLnVwZGF0ZShhdXRoeV9pZDogYXV0aHkuaWQpCiAgICAgIHJlZGlyZWN0X3RvIGFjY291bnRfcGF0aAogICAgZWxzZQogICAgICByZW5kZXIgOm5ldwogICAgZW5kCiAgZW5kCgogIHByaXZhdGUKCiAgZGVmIHVzZXJfcGFyYW1zCiAgICBwYXJhbXMucmVxdWlyZSg6dXNlcikucGVybWl0KAogICAgICA6ZW1haWwsIDpwYXNzd29yZCwgOm5hbWUsIDpjb3VudHJ5X2NvZGUsIDpwaG9uZV9udW1iZXIKICAgICkKICBlbmQKZW5kCg==</textarea>
<textarea class="saurus-file" data-file="app/views/users/new.html.erb" data-mode="html_ruby">PGgxPldlJ3JlIGdvaW5nIHRvIGJlICpCRVNUKiBmcmllbmRzPC9oMT4KPHA+IFRoYW5rcyBmb3IgeW91ciBpbnRlcmVzdCBpbiBzaWduaW5nIHVwISBDYW4geW91IHRlbGwgdXMgYSBiaXQgYWJvdXQgeW91cnNlbGY/PC9wPgoKPCUgaWYgQHVzZXIuZXJyb3JzLmFueT8gJT4KICA8aDI+T29wcywgc29tZXRoaW5nIHdlbnQgd3JvbmchPC9oMj4KCiAgPHVsPgogICAgPCUgQHVzZXIuZXJyb3JzLmZ1bGxfbWVzc2FnZXMuZWFjaCBkbyB8ZXJyb3J8ICU+CiAgICAgIDxsaT48JT0gZXJyb3IgJT48L2xpPgogICAgPCUgZW5kIC0lPgogIDwvdWw+CjwlIGVuZCAtJT4KCjwlPSBmb3JtX2ZvciBAdXNlciBkbyB8ZnwgJT4KICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgIDwlPSBmLmxhYmVsIDpuYW1lLCAiVGVsbCB1cyB5b3VyIG5hbWU6IiAlPgogICAgPCU9IGYudGV4dF9maWVsZCA6bmFtZSwgY2xhc3M6ICJmb3JtLWNvbnRyb2wiLCBwbGFjZWhvbGRlcjogIlppbmdlbGJlcnQgQmVtYmxlZGFjayIgJT4KICA8L2Rpdj4KICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgIDwlPSBmLmxhYmVsIDplbWFpbCwgIkVudGVyIFlvdXIgRS1tYWlsIEFkZHJlc3M6IiAlPgogICAgPCU9IGYuZW1haWxfZmllbGQgOmVtYWlsLCBjbGFzczogImZvcm0tY29udHJvbCIsIHBsYWNlaG9sZGVyOiAibWVAbXlkb21haW4uY29tIiAlPgogIDwvZGl2PgogIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgPCU9IGYubGFiZWwgOnBhc3N3b3JkLCAiRW50ZXIgYSBwYXNzd29yZDoiICU+CiAgICA8JT0gZi5wYXNzd29yZF9maWVsZCA6cGFzc3dvcmQsIGNsYXNzOiAiZm9ybS1jb250cm9sIiAlPgogIDwvZGl2PgogIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgPCU9IGYubGFiZWwgOmNvdW50cnlfY29kZSAlPgogICAgPCU9IGYudGV4dF9maWVsZCA6Y291bnRyeV9jb2RlLCBjbGFzczogImZvcm0tY29udHJvbCIsIGlkOiAiYXV0aHktY291bnRyaWVzIiAlPgogIDwvZGl2PgogIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgPCU9IGYubGFiZWwgOnBob25lX251bWJlciAlPgogICAgPCU9IGYudGV4dF9maWVsZCA6cGhvbmVfbnVtYmVyLCBjbGFzczogImZvcm0tY29udHJvbCIsIGlkOiAiYXV0aHktY2VsbHBob25lIiAlPgogIDwvZGl2PgogIDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+U2lnbiB1cDwvYnV0dG9uPgo8JSBlbmQgLSU+Cg==</textarea>
<textarea class="saurus-file" data-file="app/controllers/sessions_controller.rb" data-mode="ruby">Y2xhc3MgU2Vzc2lvbnNDb250cm9sbGVyIDwgQXBwbGljYXRpb25Db250cm9sbGVyCiAgZGVmIG5ldwogICAgQHVzZXIgPSBVc2VyLm5ldwogIGVuZAoKICBkZWYgY3JlYXRlCiAgICBAdXNlciA9IFVzZXIuZmluZF9ieShlbWFpbDogcGFyYW1zWzplbWFpbF0pCiAgICBpZiBAdXNlciAmJiBAdXNlci5hdXRoZW50aWNhdGUocGFyYW1zWzpwYXNzd29yZF0pCiAgICAgIHNlc3Npb25bOnByZV8yZmFfYXV0aF91c2VyX2lkXSA9IEB1c2VyLmlkCiAgICAgIEF1dGh5OjpBUEkucmVxdWVzdF9zbXMoaWQ6IEB1c2VyLmF1dGh5X2lkKQogICAgICByZWRpcmVjdF90byBzZXNzaW9uc190d29fZmFjdG9yX3BhdGgKICAgIGVsc2UKICAgICAgQHVzZXIgfHw9IFVzZXIubmV3KGVtYWlsOiBwYXJhbXNbOmVtYWlsXSkKICAgICAgcmVuZGVyIDpuZXcKICAgIGVuZAogIGVuZAoKICBkZWYgdHdvX2ZhY3RvcgogICAgcmV0dXJuIHJlZGlyZWN0X3RvIG5ld19zZXNzaW9uX3BhdGggdW5sZXNzIHNlc3Npb25bOnByZV8yZmFfYXV0aF91c2VyX2lkXQogIGVuZAoKICBkZWYgdmVyaWZ5CiAgICBAdXNlciA9IFVzZXIuZmluZChzZXNzaW9uWzpwcmVfMmZhX2F1dGhfdXNlcl9pZF0pCiAgICB0b2tlbiA9IEF1dGh5OjpBUEkudmVyaWZ5KGlkOiBAdXNlci5hdXRoeV9pZCwgdG9rZW46IHBhcmFtc1s6dG9rZW5dKQogICAgaWYgdG9rZW4ub2s/CiAgICAgIHNlc3Npb25bOnVzZXJfaWRdID0gQHVzZXIuaWQKICAgICAgc2Vzc2lvbls6cHJlXzJmYV9hdXRoX3VzZXJfaWRdID0gbmlsCiAgICAgIHJlZGlyZWN0X3RvIGFjY291bnRfcGF0aAogICAgZWxzZQogICAgICBmbGFzaC5ub3dbOmRhbmdlcl0gPSAiSW5jb3JyZWN0IGNvZGUsIHBsZWFzZSB0cnkgYWdhaW4iCiAgICAgIHJlbmRlciA6dHdvX2ZhY3RvcgogICAgZW5kCiAgZW5kCgogIGRlZiByZXNlbmQKICAgIEB1c2VyID0gVXNlci5maW5kKHNlc3Npb25bOnByZV8yZmFfYXV0aF91c2VyX2lkXSkKICAgIEF1dGh5OjpBUEkucmVxdWVzdF9zbXMoaWQ6IEB1c2VyLmF1dGh5X2lkKQogICAgZmxhc2hbOm5vdGljZV0gPSAiVmVyaWZpY2F0aW9uIGNvZGUgcmUtc2VudCIKICAgIHJlZGlyZWN0X3RvIHNlc3Npb25zX3R3b19mYWN0b3JfcGF0aAogIGVuZAoKICBkZWYgZGVzdHJveQogICAgc2Vzc2lvbls6dXNlcl9pZF0gPSBuaWwKICAgIGZsYXNoWzpub3RpY2VdID0gIllvdSBoYXZlIGJlZW4gbG9nZ2VkIG91dCIKICAgIHJlZGlyZWN0X3RvIHJvb3RfcGF0aAogIGVuZAplbmQK</textarea>
<textarea class="saurus-file" data-file="app/controllers/application_controller.rb" data-mode="ruby">Y2xhc3MgQXBwbGljYXRpb25Db250cm9sbGVyIDwgQWN0aW9uQ29udHJvbGxlcjo6QmFzZQogICMgUHJldmVudCBDU1JGIGF0dGFja3MgYnkgcmFpc2luZyBhbiBleGNlcHRpb24uCiAgIyBGb3IgQVBJcywgeW91IG1heSB3YW50IHRvIHVzZSA6bnVsbF9zZXNzaW9uIGluc3RlYWQuCiAgcHJvdGVjdF9mcm9tX2Zvcmdlcnkgd2l0aDogOmV4Y2VwdGlvbgoKICBkZWYgY3VycmVudF91c2VyCiAgICBVc2VyLmZpbmRfYnkoaWQ6IHNlc3Npb25bOnVzZXJfaWRdKQogIGVuZAogIGhlbHBlcl9tZXRob2QgOmN1cnJlbnRfdXNlcgoKICBkZWYgc2lnbmVkX2luPwogICAgY3VycmVudF91c2VyLnByZXNlbnQ/CiAgZW5kCiAgaGVscGVyX21ldGhvZCA6c2lnbmVkX2luPwoKICBwcm90ZWN0ZWQKCiAgZGVmIGF1dGhlbnRpY2F0ZSEKICAgIHJlZGlyZWN0X3RvIG5ld19zZXNzaW9uX3BhdGggYW5kIHJldHVybiB1bmxlc3Mgc2lnbmVkX2luPwogIGVuZAplbmQK</textarea>
<textarea class="saurus-file" data-file="app/controllers/accounts_controller.rb" data-mode="ruby">Y2xhc3MgQWNjb3VudHNDb250cm9sbGVyIDwgQXBwbGljYXRpb25Db250cm9sbGVyCiAgYmVmb3JlX2ZpbHRlciA6YXV0aGVudGljYXRlIQoKICBkZWYgc2hvdwogICAgQHVzZXIgPSBjdXJyZW50X3VzZXIKICBlbmQKZW5kCg==</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>